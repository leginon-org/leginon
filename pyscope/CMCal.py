#
# CM calibration table
# Author: Min Su
#         Wen Jiang
#
# Change Log:
# 12-29-2006 Min Su Implementation


 
# ------- unit calibration --------
f_defocus_H_rate = 1.0     # The measured defocus and indicated defocus has a factor of 1.65,
#f_defocus_H_rate = 1.65     # The measured defocus and indicated defocus has a factor of 1.65,
                            # which was calibrated by Min and Yujun on 12-03-2007.
f_defocus_H = 0.04 * f_defocus_H_rate  # 0.04 * f_defocus_H_rate micron meter per cliks in stepsize 3.
		                    # Calibrated by Min Su on Aug.27,2006(Sunday).
f_defocus_L = 300.0/1000.0  # 300 micron meter per thousand cliks in stepsize 1.
		                    # Calibrated by Min Su on Aug.27,2006(Sunday).		                    
f_beamshiftx = 87.0/100.0   # 87 unit change in x direction per 100 clicks at 50,000X
f_beamshifty = 87.0/100.0   # same rate as in x direction. Calibrated on Sept.29,2006.
f_imageshiftx = 2           # the x and y ratios have been calibrated by Min Su.
f_imageshifty = 2
f_intensity = 13020.0/100.0
backlash = 1000

imgshiftpix = [ {'x': None, 'y': None},
                {'x': None, 'y': None},
                {'x': None, 'y': None},
                {'x': None, 'y': None},
                {'x': None, 'y': None},
                {'x': None, 'y': None},
                {'x': 660.0/15.0*500.0/520.0/1e-6, 'y': 660.0/15.0*500.0/520.0/1e-6},    # not calibrated
                {'x': None, 'y': None},
                {'x': None, 'y': None},
                {'x': None, 'y': None},
                {'x': None, 'y': None},
                {'x': None, 'y': None},
                {'x': 660.0/15.0*500.0/520.0/1e-6, 'y': 660.0/15.0*500.0/520.0/1e-6},    # not calibrated
                {'x': 1500.0/15.0*500.0/520.0/1e-6, 'y': 1500.0/15.0*500.0/520.0/1e-6},
                {'x': 1500.0/15.0*500.0/520.0/1e-6, 'y': 1500.0/15.0*500.0/520.0/1e-6}, 
                {'x': 2100.0/15.0*500.0/520.0/1e-6, 'y': 2100.0/15.0*500.0/520.0/1e-6},    # not calibrated
                {'x': 2240.0/15.0*500.0/520.0/1e-6,'y': 2240.0/15.0*500.0/520.0/1e-6},
                {'x': 2800.0/15.0*500.0/520.0/1e-6,'y': 2800.0/15.0*500.0/520.0/1e-6},
                {'x': 3850.0/15.0*500.0/520.0/1e-6,'y': 3850.0/15.0*500.0/520.0/1e-6},
                {'x': 5310.0/15.0*500.0/520.0/1e-6,'y': 5310.0/15.0*500.0/520.0/1e-6},
                {'x': 7469.0/15.0*500.0/90.0/1e-6, 'y': 7469.0/15.0*500.0/90.0/1e-6},     # calibrated
                {'x': 9230.0/15.0*200.0/190.0/1e-6,  'y': 9230.0/15.0*200.0/190.0/1e-6},
                {'x': 12220.0/15.0*200.0/190.0/1e-6, 'y': 12220.0/15.0*200.0/190.0/1e-6},
                {'x': 15770.0/15.0*200.0/190.0/1e-6, 'y': 15770.0/15.0*200.0/190.0/1e-6},
                {'x': 20570.0/15.0*200.0/190.0/1e-6, 'y': 20570.0/15.0*200.0/190.0/1e-6},
                {'x': 27720.0/15.0*200.0/190.0/1e-6, 'y': 27720.0/15.0*200.0/190.0/1e-6},
                {'x': 37760.0/15.0*200.0/190.0/1e-6, 'y': 37760.0/15.0*200.0/190.0/1e-6},
                {'x': 52260.0/15.0*200.0/190.0/1e-6, 'y': 52260.0/15.0*200.0/190.0/1e-6},
                {'x': 68050.0/15.0*500.0/820.0/1e-6, 'y': 68050.0/15.0*500.0/820.0/1e-6},  # calibrated
                {'x': 88860.0/15.0*200.0/190.0/1e-6, 'y': 88860.0/15.0*200.0/190.0/1e-6},
                {'x': 118820.0/15.0*200.0/190.0/1e-6,'y': 118820.0/15.0*200.0/190.0/1e-6},
                {'x': 159870.0/15.0*200.0/190.0/1e-6,'y': 159870.0/15.0*200.0/190.0/1e-6},
                {'x': 208570.0/15.0*200.0/190.0/1e-6,'y': 208570.0/15.0*200.0/190.0/1e-6},
                {'x': 273560.0/15.0*200.0/190.0/1e-6,'y': 273560.0/15.0*200.0/190.0/1e-6},
                {'x': 376150.0/15.0*200.0/190.0/1e-6,'y': 376150.0/15.0*200.0/190.0/1e-6},
                {'x': 465050.0/15.0*200.0/190.0/1e-6,'y': 465050.0/15.0*200.0/190.0/1e-6},
                {'x': 574500.0/15.0*200.0/190.0/1e-6,'y': 574500.0/15.0*200.0/190.0/1e-6},
                {'x': 807000.0/15.0*200.0/190.0/1e-6,'y': 807000.0/15.0*200.0/190.0/1e-6},
                {'x': 1121600.0/15.0*200.0/190.0/1e-6,'y': 1121600.0/15.0*200.0/190.0/1e-6},]


beamshiftpix = [{'x': None, 'y': None},
                {'x': None, 'y': None},
                {'x': None, 'y': None},
                {'x': None, 'y': None},
                {'x': None, 'y': None},
                {'x': None, 'y': None},
                {'x': 130.0/15.0*500.0/520.0/1e-6, 'y': 130.0/15.0*500.0/520.0/1e-6},    # not calibrated
                {'x': None, 'y': None},
                {'x': None, 'y': None},
                {'x': None, 'y': None},
                {'x': None, 'y': None},
                {'x': None, 'y': None},
                {'x': 660.0/15.0*500.0/520.0/1e-6, 'y': 660.0/15.0*500.0/520.0/1e-6},    # not calibrated
                {'x': None, 'y': None},
                {'x': None, 'y': None},
                {'x': 2100.0/15.0*500.0/520.0/1e-6, 'y': 2100.0/15.0*500.0/520.0/1e-6},    # not calibrated
                {'x': 2240.0/15.0*500.0/520.0/1e-6,'y': 2240.0/15.0*500.0/520.0/1e-6},
                {'x': 2800.0/15.0*500.0/520.0/1e-6,'y': 2800.0/15.0*500.0/520.0/1e-6},
                {'x': 3850.0/15.0*500.0/520.0/1e-6,'y': 3850.0/15.0*500.0/520.0/1e-6},
                {'x': 5310.0/15.0*500.0/520.0/1e-6,'y': 5310.0/15.0*500.0/520.0/1e-6},
                {'x': 7469.0/15.0*500.0/90.0/1e-6, 'y': 7469.0/15.0*500.0/90.0/1e-6},     # calibrated
                {'x': 9230.0/15.0*200.0/190.0/1e-6,  'y': 9230.0/15.0*200.0/190.0/1e-6},
                {'x': 12220.0/15.0*200.0/190.0/1e-6, 'y': 12220.0/15.0*200.0/190.0/1e-6},
                {'x': 15770.0/15.0*200.0/190.0/1e-6, 'y': 15770.0/15.0*200.0/190.0/1e-6},
                {'x': 20570.0/15.0*200.0/190.0/1e-6, 'y': 20570.0/15.0*200.0/190.0/1e-6},
                {'x': 27720.0/15.0*200.0/190.0/1e-6, 'y': 27720.0/15.0*200.0/190.0/1e-6},
                {'x': 37760.0/15.0*200.0/190.0/1e-6, 'y': 37760.0/15.0*200.0/190.0/1e-6},
                {'x': 52260.0/15.0*200.0/190.0/1e-6, 'y': 52260.0/15.0*200.0/190.0/1e-6},
                {'x': 68050.0/15.0*500.0/820.0/1e-6, 'y': 68050.0/15.0*500.0/820.0/1e-6},  # calibrated
                {'x': 88860.0/15.0*200.0/190.0/1e-6, 'y': 88860.0/15.0*200.0/190.0/1e-6},
                {'x': 118820.0/15.0*200.0/190.0/1e-6,'y': 118820.0/15.0*200.0/190.0/1e-6},
                {'x': 159870.0/15.0*200.0/190.0/1e-6,'y': 159870.0/15.0*200.0/190.0/1e-6},
                {'x': 208570.0/15.0*200.0/190.0/1e-6,'y': 208570.0/15.0*200.0/190.0/1e-6},
                {'x': 273560.0/15.0*200.0/190.0/1e-6,'y': 273560.0/15.0*200.0/190.0/1e-6},
                {'x': 376150.0/15.0*200.0/190.0/1e-6,'y': 376150.0/15.0*200.0/190.0/1e-6},
                {'x': 465050.0/15.0*200.0/190.0/1e-6,'y': 465050.0/15.0*200.0/190.0/1e-6},
                {'x': 574500.0/15.0*200.0/190.0/1e-6,'y': 574500.0/15.0*200.0/190.0/1e-6},
                {'x': 807000.0/15.0*200.0/190.0/1e-6,'y': 807000.0/15.0*200.0/190.0/1e-6},
                {'x': 1121600.0/15.0*200.0/190.0/1e-6,'y': 1121600.0/15.0*200.0/190.0/1e-6},]



# ------- Spotsize table --------
# Low Mag setting
LMSS = [350,270,180,130,95,66,45,30.5,18,13,8.5]   # enforce 30 to 30.5 to avoid conflict with HMSS[]

# High Mag setting
HMSS = [40,30,20,15,10,7.5,5,3.5,2,1.5,1.2]


# -------- Magnification table ---------
## Purdue
if False:
    # screen up
    screenup_mag = [25, 33, 43, 57, 75, 100, 130, 170, 220, 290,
        380, 500, 660, 870, 1150, 1500, 1600, 2000, 2750, 3800,
        5000, 6600, 8800, 11500, 15000, 20000, 27500, 38000, 50000, 66000,
        88000, 115000, 150000, 200000, 275000, 340000, 420000, 590000, 820000]

    # screen down - Film
    screendown_mag = [22, 29, 38, 50, 66, 88, 115, 150, 195, 255,
        340, 440, 580, 770, 1000, 1350, 1400, 1750, 2450, 3400,
        4400, 5800, 7800, 10000, 13500, 17500, 24500, 34000, 44000, 58000,
        78000, 100000, 135000, 175000, 245000, 300000, 370000, 520000, 730000]

    # screen down - CCD Camera
    # calibrated between 9230 - 273560
    screenup_mag_ccd = [25, 33, 43, 57, 75, 100, 130, 170, 220, 290,
        530, 700, 920, 1220, 1610, 2100, 2240, 2800, 3850, 5310,
        6690, 9230, 12220, 15770, 20570, 27720, 37760, 52260, 68050, 88860,
        118820, 159870, 208570, 273560, 376150, 465050, 574500, 807000, 1121600]

## FSU CM300
if True:
    import cm300mags
    screenup_mag = cm300mags.screenup
    screendown_mag = cm300mags.screendown

# ------- The turnknob ID --------
TK_Ratio          = 0	 
TK_Contrast       = 1	
TK_Brightness     = 2	
TK_Zoom           = 3	
TK_Magnification  = 6	
TK_FocusKnob      = 7	
TK_FocusStep      = 8	
TK_Intensity      = 9
TK_ShiftX         = 12
TK_ShiftY	      = 13
TK_MultifunctionX = 14
TK_MultifunctionY = 15
TK_SpotSize 	  = 16
TK_Filament	      = 17


# ------- The pushbutton ID --------
PB_ON           = 0
PB_OFF          = 1
PB_PRESS        = 2
PB_Diffraction	= 3	
PB_Autofocus	= 4	
PB_Reset	    = 6	
PB_Ready	    = 7	
PB_Stigmator	= 27	
PB_DarkField	= 28	
PB_Alignment	= 29	
PB_VacuumOn     = 31	
PB_FullFrame    = 32	
PB_SelectedArea = 33	
PB_Crosshairs   = 34	
PB_Line	        = 35	
PB_Scanstop	    = 36	
PB_Slow	        = 37	
PB_Fast	        = 38	
PB_TV	        = 39	
PB_DualSignal	= 41	
PB_DualMag	    = 42
PB_SplitScreen	= 43
PB_ExchSignal	= 44
PB_Exp1	        = 45
PB_Exp2	        = 46
PB_Exp3	        = 47
PB_Zmode	    = 48
PB_YZmode	    = 49
PB_Ymode	    = 50
PB_StemExposure = 51
PB_SetButton	= 52
PB_AutoButton	= 53
PB_InvertSignal = 54
PB_ExchControl	= 55
PB_Exposure	    = 60
PB_IntRST	    = 61
PB_IntFine	    = 62
PB_Wobbler	    = 63


# ------- Direct Operation ID --------
DO_DMode            = 1
DO_FocusStep        = 2
DO_HMSAMag          = 3
DO_HTStep           = 4
DO_LADMode          = 5
DO_LMMag            = 6
DO_SpotSize         = 8
DO_HT               = 9
DO_BeamBlankON      = 10
DO_BeamBlankOFF     = 11
DO_EDXProtectionON  = 12
DO_EDXProtectionOFF = 13
DO_ExXYDefON        = 14
DO_ExXYDefOFF       = 15
DO_NormImgLens      = 16
